{"version":3,"sources":["instagramByAccount.js"],"names":["$","document","ready","it","$wrapper","$container","find","$loading","$token","attr","$user","$accountName","trim","$batchClass","$cachedWidth","prop","getInstagramByAccount","access_token","$number","$numbers","window","matchMedia","parseInt","empty","$url","ajax","url","type","dataType","success","data","i","img","images","standard_resolution","link","caption","text","append","batch","each","k","e","addClass","appendTo","wrapInner","error","xhr","status","console","log","responseText","complete","hide","rotator","css","fn","options","extend","blocks","speed","fadeSpeed","rotate","element","len","length","index","fadeIn","timer","setInterval","block","eq","clearInterval","fadeOut","this","elem","click","y","max","offset","top","outerHeight","min","pageY","location","href","onresize","$newWidth","show","clearTimeout","setTimeout","jQuery"],"mappings":"CAYA,SAAWA,GACT,aACAA,EAAEC,UAAUC,MAAM,WAChB,IA+GIC,EA/GAC,EAAWJ,EAAE,OACbK,EAAaD,EAASE,KAAK,aAC3BC,EAAWH,EAASE,KAAK,eACzBE,EAASJ,EAASK,KAAK,cACvBC,EAAQN,EAASK,KAAK,gBACtBE,OAAiC,IAAVD,EAAyB,2BAA6BA,EAAME,OACnFC,EAAc,QACdC,EAAed,EAAE,QAAQe,KAAK,eAElC,SAASC,EAAsBC,GAE7B,IAAIC,EAAUd,EAASK,KAAK,eAExBU,EAAYC,OAAOC,WAAW,sBAA6B,QAAI,EAAIC,SAASJ,GAEhF,GADAb,EAAWkB,QACPN,EAAc,CAChB,IAAIO,EAAO,sEAAwEP,EACnFjB,EAAEyB,KAAK,CACLC,IAAKF,EACLG,KAAM,MACNC,SAAU,QACVC,QAAS,SAAUC,GAEjB,IAAK,IAAIC,EAAI,EAAGA,EAXR,GAWqBA,IAAK,CAChC,IAAIC,EAAMF,EAAKA,KAAKC,GAAGE,OAAOC,oBAAoBR,IAC9CS,EAAOL,EAAKA,KAAKC,GAAGI,KACbL,EAAKA,KAAKC,GAAGK,QAAQC,KAChChC,EAAWiC,OAAO,YAAcH,EAAO,+BAAiCH,EAAM,UAAYtB,EAAQ,UAEpG,IAAI6B,EACJvC,EAAE,IAAKK,GAAYmC,KAAK,SAAUC,EAAGC,GAC/BD,EAAItB,GAAY,IAClBoB,EAAQvC,EAAE,UAAU2C,SAAS9B,GAAa+B,SAASvC,IAErDkC,EAAMD,OAAOI,KAGf1C,EAAE,IAAMa,GAAagC,UADV,8BAGbC,MAAO,SAAUC,EAAKC,EAAQF,GAC5BG,QAAQC,IAAIH,EAAII,eAElBC,SAAU,WACR7C,EAAS8C,OACThD,EAAWiD,UACXlD,EAASmD,IAAI,aAAc,eAMnCvD,EAAEwD,GAAGF,QAAU,SAAUG,GACvBA,EAAUzD,EAAE0D,OAAO,CACjBC,OAAQvD,EAASE,KAAK,IAAMO,GAC5B+C,MAAO,IACPC,UAAW,KACVJ,GACH,IAOIK,EAAS,SAAUC,GACrB,IAAIJ,EAAS3D,EAAEyD,EAAQE,OAAQI,GAC7BC,EAAML,EAAOM,OACbC,GAAS,EACXP,EAAOQ,OAAOV,EAAQI,WACtB,IAAIO,EAAQC,YAAY,WACtBH,IACA,IAAII,EAAQX,EAAOY,GAAGL,GAClBA,GAASF,IACXQ,cAAcJ,GACdN,EAAOC,IAELO,EAAMJ,SAAYF,EAAM,GAC1BM,EAAMG,QAAQhB,EAAQI,YAEvBJ,EAAQG,QAEb,OAAOc,KAAKlC,KAAK,WACf,IAzBwBuB,EACpBG,EAwBAS,EAAO3E,EAAE0E,MAzBWX,EA0BdY,EAzBNT,EAAQlE,EAAEyD,EAAQE,OAAQI,GAASE,OACvCjE,EAAEyD,EAAQE,OAAQI,GAASvB,KAAK,WAC9B0B,IACAlE,EAAE0E,MAAMnB,IAAI,SAAUW,KAuBxBJ,EAAOa,MAIPnE,EAEFQ,EAAsBR,GAEtByC,QAAQC,IAAI,sHAGd9C,EAASwE,MAAM,SAAUlC,GAGvB,IAG2BmC,EAHvBC,EAAM9E,EAAE0E,MAAMK,SAASC,IAAMhF,EAAE0E,MAAMO,cACrCC,EAAMJ,EAAM,GAEWD,EAGZnC,EAAEyC,MAFFD,GAALL,GAAYA,GAAKC,IAIzBM,SAASC,KAAO,6BAA+B1E,KAOnDS,OAAOkE,SAAW,WAChB,IAAIC,EAAYvF,EAAE,QAAQe,KAAK,eAC3BwE,IAAczE,IAChBP,EAASiF,OACTC,aAAatF,GACbA,EAAKuF,WAAW,WACd1E,EAAsBR,IACrB,KACHM,EAAeyE,MA5HvB,CAiIGI","file":"instagramByAccount.min.js","sourcesContent":["/* NEL, KU KOM Script to fetch images from Instagram by access token.\n * Login to Instagram to register an application and generate an access token using this url - replace with your values:\n * https://api.instagram.com/oauth/authorize/?client_id=CLIENT-ID&redirect_uri=REDIRECT-URI&response_type=token\n * Needs html like this: <div id=\"ig\" data-account=\"university_of_copenhagen\" data-token=\"xxxx\" data-images=\"3\" class=\"gridbox with-img size2\">\n   <div class=\"box1\">\n     <a href=\"https://www.instagram.com/university_of_copenhagen/\">\n       <div class=\"header\">@university_of_copenhagen p√• Instagram</div>\n     </a>\n   </div>\n     <div id=\"imageBox\"></div>\n </div>\n The property data-account represents the account name to search for. data-images pepresents the number of images to display at a time. */\n(function ($) {\n  'use strict';\n  $(document).ready(function () {\n    var $wrapper = $(\"#ig\");\n    var $container = $wrapper.find(\"#imageBox\");\n    var $loading = $wrapper.find(\".ku-loading\");\n    var $token = $wrapper.attr(\"data-token\");\n    var $user = $wrapper.attr(\"data-account\");\n    var $accountName = (typeof $user === 'undefined') ? 'university_of_copenhagen' : $user.trim();\n    var $batchClass = \"batch\";\n    var $cachedWidth = $('body').prop('clientWidth');\n\n    function getInstagramByAccount(access_token) {\n      // Fetch Instagram images by hashtag\n      var $number = $wrapper.attr(\"data-images\");\n      var $images = 12;\n      var $numbers = (window.matchMedia('(max-width: 480px)').matches) ? 1 : parseInt($number);\n      $container.empty();\n      if (access_token) {\n        var $url = \"https://api.instagram.com/v1/users/self/media/recent/?access_token=\" + access_token;\n        $.ajax({\n          url: $url,\n          type: 'GET',\n          dataType: \"jsonp\",\n          success: function (data) {\n            //console.log(data);\n            for (var i = 0; i < $images; i++) {\n              var img = data.data[i].images.standard_resolution.url;\n              var link = data.data[i].link;\n              var desc = data.data[i].caption.text;\n              $container.append('<a href=\"' + link + '\" target=\"_blank\"><img src=\"' + img + '\" alt=\"' + $user + '\"></a>');\n            }\n            var batch;\n            $('a', $container).each(function (k, e) {\n              if (k % $numbers == 0) {\n                batch = $('<div/>').addClass($batchClass).appendTo($container);\n              }\n              batch.append(e);\n            });\n            var wrap = \"<div class='inner'></div>\";\n            $('.' + $batchClass).wrapInner(wrap);\n          },\n          error: function (xhr, status, error) {\n            console.log(xhr.responseText);\n          },\n          complete: function () {\n            $loading.hide();\n            $container.rotator();\n            $wrapper.css('visibility', 'visible');\n          }\n        });\n      }\n    }\n\n    $.fn.rotator = function (options) {\n      options = $.extend({\n        blocks: $wrapper.find('.' + $batchClass),\n        speed: 6000,\n        fadeSpeed: 800\n      }, options);\n      var setZIndex = function (element) {\n        var index = $(options.blocks, element).length;\n        $(options.blocks, element).each(function () {\n          index--;\n          $(this).css('zIndex', index);\n        });\n      };\n      var rotate = function (element) {\n        var blocks = $(options.blocks, element),\n          len = blocks.length,\n          index = -1;\n        blocks.fadeIn(options.fadeSpeed);\n        var timer = setInterval(function () {\n          index++;\n          var block = blocks.eq(index);\n          if (index == len) {\n            clearInterval(timer);\n            rotate(element);\n          }\n          if (block.index() != (len - 1)) {\n            block.fadeOut(options.fadeSpeed);\n          }\n        }, options.speed);\n      };\n      return this.each(function () {\n        var elem = $(this);\n        setZIndex(elem);\n        rotate(elem);\n      });\n    };\n\n    if ($token) {\n      // Init script\n      getInstagramByAccount($token);\n    } else {\n      console.log('Add Instagram access token and number of images to display using data-token=\"\" and data-images=\"\" on the container');\n    }\n\n    $wrapper.click(function (e) {\n      // Action when gridbox arrow is clicked\n      // clickable range - never changes\n      var max = $(this).offset().top + $(this).outerHeight();\n      var min = max - 30; // 30 is the height of the ::before arrow\n\n      var checkRange = function (y) {\n        return (y >= min && y <= max);\n      };\n      if (checkRange(e.pageY)) {\n        // do click action\n        location.href = \"https://www.instagram.com/\" + $accountName;\n      }\n    });\n\n    //On resize, wait and reload function\n    var it;\n\n    window.onresize = function () {\n      var $newWidth = $('body').prop('clientWidth');\n      if ($newWidth !== $cachedWidth) {\n        $loading.show();\n        clearTimeout(it);\n        it = setTimeout(function () {\n          getInstagramByAccount($token);\n        }, 200);\n        $cachedWidth = $newWidth;\n      }\n    };\n  });\n\n})(jQuery);\n"]}