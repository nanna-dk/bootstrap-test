{"version":3,"sources":["instagramByHashtag.js"],"names":["$","document","ready","it","$cachedWidth","prop","$wrapper","$container","find","$hash","attr","toLowerCase","trim","$batchClass","$loading","getInstagramByHash","hashtag","$number","$numbers","window","matchMedia","parseInt","empty","ajax","url","type","dataType","data","success","batch","entry","entry_data","TagPage","graphql","edge_hashtag_to_media","edges","each","i","v","img","node","thumbnail_src","shortcode","append","$images","k","e","addClass","appendTo","wrapInner","error","xhr","status","console","log","responseText","complete","hide","rotator","css","fn","options","extend","blocks","speed","fadeSpeed","rotate","element","len","length","index","fadeIn","timer","setInterval","block","eq","clearInterval","fadeOut","this","elem","onresize","$newWidth","show","clearTimeout","setTimeout","jQuery"],"mappings":"CAKA,SAAWA,GACT,aACAA,EAAEC,UAAUC,MAAM,WAChB,IAkGIC,EAlGAC,EAAeJ,EAAE,QAAQK,KAAK,eAC9BC,EAAWN,EAAE,eACbO,EAAaD,EAASE,KAAK,aAC3BC,OAAkD,IAAlCH,EAASI,KAAK,gBAAmC,KAAOJ,EAASI,KAAK,gBAAgBC,cAAcC,OACpHC,EAAc,QACdC,EAAWR,EAASE,KAAK,eAE7B,SAASO,EAAmBC,GAE1B,IAAIC,EAAUX,EAASI,KAAK,eAExBQ,EAAYC,OAAOC,WAAW,sBAA6B,QAAI,EAAIC,SAASJ,GAEhF,GADAV,EAAWe,QACPN,EAAS,CAEXhB,EAAEuB,KAAK,CACLC,IAFS,mFAGTC,KAAM,OACNC,SAAU,OACVC,KAAM,CACJX,QAASP,GAEXmB,QAAS,SAAUD,GAEjB,IAOIE,EAPAC,EAAQH,EAAKI,WAAWC,QAAQ,GAAGC,QAAQjB,QAAQkB,sBAAsBC,MAC7EnC,EAAEoC,KAAKN,EAAO,SAAUO,EAAGC,GACzB,IAAIC,EAAMT,EAAMO,GAAGG,KAAKC,cACpBC,EAAYZ,EAAMO,GAAGG,KAAKE,UAE9B,OADAnC,EAAWoC,OAAO,wCAA0CD,EAAY,gCAAkCH,EAAM,UAAYvB,EAAU,UAC/HqB,EAAIO,KAGb5C,EAAE,IAAKO,GAAY6B,KAAK,SAAUS,EAAGC,GAC/BD,EAAI3B,GAAY,IAClBW,EAAQ7B,EAAE,UAAU+C,SAASlC,GAAamC,SAASzC,IAErDsB,EAAMc,OAAOG,KAGf9C,EAAE,IAAMa,GAAaoC,UADV,8BAGbC,MAAO,SAAUC,EAAKC,EAAQF,GAC5BG,QAAQC,IAAIH,EAAII,eAElBC,SAAU,WACR1C,EAAS2C,OACTlD,EAAWmD,UACXpD,EAASqD,IAAI,aAAc,eAMnC3D,EAAE4D,GAAGF,QAAU,SAAUG,GACvBA,EAAU7D,EAAE8D,OAAO,CACjBC,OAAQzD,EAASE,KAAK,IAAMK,GAC5BmD,MAAO,IACPC,UAAW,KACVJ,GACH,IAOIK,EAAS,SAAUC,GACrB,IAAIJ,EAAS/D,EAAE6D,EAAQE,OAAQI,GAC7BC,EAAML,EAAOM,OACbC,GAAS,EACXP,EAAOQ,OAAOV,EAAQI,WACtB,IAAIO,EAAQC,YAAY,WACtBH,IACA,IAAII,EAAQX,EAAOY,GAAGL,GAClBA,GAASF,IACXQ,cAAcJ,GACdN,EAAOC,IAELO,EAAMJ,SAAYF,EAAM,GAC1BM,EAAMG,QAAQhB,EAAQI,YAEvBJ,EAAQG,QAEb,OAAOc,KAAK1C,KAAK,WACf,IAzBwB+B,EACpBG,EAwBAS,EAAO/E,EAAE8E,MAzBWX,EA0BdY,EAzBNT,EAAQtE,EAAE6D,EAAQE,OAAQI,GAASE,OACvCrE,EAAE6D,EAAQE,OAAQI,GAAS/B,KAAK,WAC9BkC,IACAtE,EAAE8E,MAAMnB,IAAI,SAAUW,KAuBxBJ,EAAOa,MAKPtE,EACFM,EAAmBN,GAEnB4C,QAAQC,IAAI,iIAMdnC,OAAO6D,SAAW,WAChB,IAAIC,EAAYjF,EAAE,QAAQK,KAAK,eAC3B4E,IAAc7E,IAChBU,EAASoE,OACTC,aAAahF,GACbA,EAAKiF,WAAW,WACdrE,EAAmBN,IAClB,KACHL,EAAe6E,MA/GvB,CAmHGI","file":"instagramByHashtag.min.js","sourcesContent":["/* NEL, KU KOM\n * Script to fetch images from Instagram by hashtag. Based on scrapung - may stop working at any time.\n * Needs html like this: <div id=\"instagram_hash\" data-hashtag=\"blivstuderendepÃ¥Kinastudier\" data-images=\"6\" class=\"instagram-box\"></div>\n * data-hashtag represents the hashtag to search for.\n * data-images pepresents the number of images to display at a time. */\n(function ($) {\n  'use strict';\n  $(document).ready(function () {\n    var $cachedWidth = $('body').prop('clientWidth');\n    var $wrapper = $('#ig_hashtag');\n    var $container = $wrapper.find(\"#imageBox\");\n    var $hash = (typeof $wrapper.attr(\"data-hashtag\") === 'undefined') ? null : $wrapper.attr(\"data-hashtag\").toLowerCase().trim();\n    var $batchClass = \"batch\";\n    var $loading = $wrapper.find(\".ku-loading\");\n\n    function getInstagramByHash(hashtag) {\n      // Fetch Instagram images by hashtag\n      var $number = $wrapper.attr(\"data-images\");\n      var $images = 12;\n      var $numbers = (window.matchMedia('(max-width: 480px)').matches) ? 1 : parseInt($number);\n      $container.empty();\n      if (hashtag) {\n        var $url = \"https://cms.secure.ku.dk/instacms/instagramByUserOrTag/instagramScrapeToJson.php\";\n        $.ajax({\n          url: $url,\n          type: 'post',\n          dataType: \"json\",\n          data: ({\n            hashtag: $hash\n          }),\n          success: function (data) {\n            //console.log(data);\n            var entry = data.entry_data.TagPage[0].graphql.hashtag.edge_hashtag_to_media.edges;\n            $.each(entry, function (i, v) {\n              var img = entry[i].node.thumbnail_src;\n              var shortcode = entry[i].node.shortcode;\n              $container.append('<a href=\"https://www.instagram.com/p/' + shortcode + ' \" target=\"_blank\"><img src=\"' + img + '\" alt=\"' + hashtag + '\"></a>');\n              return i < $images - 1;\n            });\n            var batch;\n            $('a', $container).each(function (k, e) {\n              if (k % $numbers == 0) {\n                batch = $('<div/>').addClass($batchClass).appendTo($container);\n              }\n              batch.append(e);\n            });\n            var wrap = \"<div class='inner'></div>\";\n            $('.' + $batchClass).wrapInner(wrap);\n          },\n          error: function (xhr, status, error) {\n            console.log(xhr.responseText);\n          },\n          complete: function () {\n            $loading.hide();\n            $container.rotator();\n            $wrapper.css('visibility', 'visible');\n          }\n        });\n      }\n    }\n\n    $.fn.rotator = function (options) {\n      options = $.extend({\n        blocks: $wrapper.find('.' + $batchClass),\n        speed: 6000,\n        fadeSpeed: 800\n      }, options);\n      var setZIndex = function (element) {\n        var index = $(options.blocks, element).length;\n        $(options.blocks, element).each(function () {\n          index--;\n          $(this).css('zIndex', index);\n        });\n      };\n      var rotate = function (element) {\n        var blocks = $(options.blocks, element),\n          len = blocks.length,\n          index = -1;\n        blocks.fadeIn(options.fadeSpeed);\n        var timer = setInterval(function () {\n          index++;\n          var block = blocks.eq(index);\n          if (index == len) {\n            clearInterval(timer);\n            rotate(element);\n          }\n          if (block.index() != (len - 1)) {\n            block.fadeOut(options.fadeSpeed);\n          }\n        }, options.speed);\n      };\n      return this.each(function () {\n        var elem = $(this);\n        setZIndex(elem);\n        rotate(elem);\n      });\n    };\n\n    // Init script\n    if ($hash) {\n      getInstagramByHash($hash);\n    } else {\n      console.log('Add Instagram hashtag to search for and number of images to display using data-hashtag=\"\" and data-images=\"\" on the container');\n    }\n\n    //On resize, wait and reload function\n    var it;\n\n    window.onresize = function () {\n      var $newWidth = $('body').prop('clientWidth');\n      if ($newWidth !== $cachedWidth) {\n        $loading.show();\n        clearTimeout(it);\n        it = setTimeout(function () {\n          getInstagramByHash($hash);\n        }, 200);\n        $cachedWidth = $newWidth;\n      }\n    };\n  });\n})(jQuery);\n"]}